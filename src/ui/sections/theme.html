<div class="section-content" id="section-theme">
    <!-- Mode Toggle -->
    <div class="tab-toggle" style="margin-bottom: var(--space-6);">
        <button id="mode-generate" class="toggle-btn active">Generate New</button>
        <button id="mode-edit" class="toggle-btn">Edit Existing</button>
    </div>

    <!-- Mode: Generate -->
    <div id="theme-mode-generate">
        <!-- Theme Name -->
        <div class="card" style="margin-bottom: var(--space-4);">
            <div class="section-title">Theme Name</div>
            <div class="form-group">
                <input type="text" id="theme-name" value="Theme" placeholder="e.g. My Product Theme">
            </div>
        </div>

        <!-- Step 1: Source -->
        <div class="card" style="margin-bottom: var(--space-4);">
            <div class="section-title">1. Source Palettes</div>
            <p class="step-description">Select where your color palettes are stored</p>

            <div class="flex-row">
                <div class="form-group">
                    <label>Collection</label>
                    <select id="theme-source-collection">
                        <option value="" disabled selected>Select collection...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Group (Optional)</label>
                    <select id="theme-source-group" disabled>
                        <option value="">All groups</option>
                    </select>
                </div>
            </div>

            <button id="load-palettes-btn" class="secondary" style="width: 100%; margin-top: var(--space-3);">
                <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path
                            d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z" />
                    </svg></span> Load Palettes
            </button>
        </div>
    </div>

    <!-- Mode: Edit -->
    <div id="theme-mode-edit" style="display: none;">
        <div class="card" style="margin-bottom: var(--space-4);">
            <div class="section-title">Select Theme Collection</div>
            <p class="step-description">Choose an existing theme collection to edit</p>

            <div class="flex-row">
                <div class="form-group">
                    <label>Theme Collection</label>
                    <select id="theme-edit-collection">
                        <option value="" disabled selected>Select theme...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Theme Group (Optional)</label>
                    <select id="theme-edit-group" disabled>
                        <option value="">(Root)</option>
                    </select>
                </div>
            </div>

            <button id="load-existing-theme-btn" class="primary" style="width: 100%; margin-top: var(--space-3);">
                <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
                        <polyline points="14 2 14 8 20 8" />
                        <line x1="16" x2="8" y1="13" y2="13" />
                        <line x1="16" x2="8" y1="17" y2="17" />
                        <line x1="10" x2="8" y1="9" y2="9" />
                    </svg></span> Load Theme Tokens
            </button>
        </div>
    </div>

    <!-- Step 2: Semantic Mapping -->
    <div class="card" style="margin-bottom: var(--space-4);">
        <div class="section-title">2. Semantic Mapping</div>
        <p class="step-description">Map your palettes to semantic roles</p>

        <div class="semantic-grid">
            <div class="semantic-card primary-semantic">
                <span class="semantic-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="13.5" cy="6.5" r=".5" />
                        <circle cx="17.5" cy="10.5" r=".5" />
                        <circle cx="8.5" cy="7.5" r=".5" />
                        <circle cx="6.5" cy="12.5" r=".5" />
                        <path
                            d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z" />
                    </svg></span>
                <span class="semantic-label">Accent / Brand</span>
                <select id="theme-accent-palette" disabled></select>
            </div>
            <div class="semantic-card neutral-semantic">
                <span class="semantic-icon">â¬œ</span>
                <span class="semantic-label">Neutral / Surface</span>
                <select id="theme-neutral-palette" disabled></select>
            </div>
        </div>

        <div class="sub-label">Status Palettes (Optional)</div>

        <div class="status-grid">
            <div class="status-card success">
                <span class="status-indicator" style="background: #10b981;"></span>
                <span class="status-label">Success</span>
                <select id="theme-success-palette" disabled></select>
            </div>
            <div class="status-card warning">
                <span class="status-indicator" style="background: #f59e0b;"></span>
                <span class="status-label">Warning</span>
                <select id="theme-warning-palette" disabled></select>
            </div>
            <div class="status-card error">
                <span class="status-indicator" style="background: #ef4444;"></span>
                <span class="status-label">Error</span>
                <select id="theme-error-palette" disabled></select>
            </div>
        </div>
    </div>

    <!-- Step 3: Preview & Editor -->
    <div id="theme-preview-section" class="card preview-section" style="display: none;">
        <div class="preview-header">
            <div class="section-title" style="margin: 0;">3. Theme Editor</div>
            <div class="theme-mode-switch">
                <button id="view-light" class="mode-switch-btn active">
                    <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="4" />
                            <path d="M12 2v2" />
                            <path d="M12 20v2" />
                            <path d="m4.93 4.93 1.41 1.41" />
                            <path d="m17.66 17.66 1.41 1.41" />
                            <path d="M2 12h2" />
                            <path d="M20 12h2" />
                            <path d="m6.34 17.66-1.41 1.41" />
                            <path d="m19.07 4.93-1.41 1.41" />
                        </svg></span> Light
                </button>
                <button id="view-dark" class="mode-switch-btn">
                    <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />
                        </svg></span> Dark
                </button>
            </div>
        </div>

        <!-- Live Preview -->
        <div id="theme-preview-board" class="theme-preview-board">
            <!-- Rendered via JS -->
        </div>

        <!-- Token Editor -->
        <div class="editor-accordion">
            <details open>
                <summary>
                    <span class="summary-icon"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="12 2 2 7 12 12 22 7 12 2" />
                            <polyline points="2 17 12 22 22 17" />
                            <polyline points="2 12 12 17 22 12" />
                        </svg></span>
                    Background & Surface
                </summary>
                <div class="token-grid" id="editor-bg"></div>
            </details>
            <details>
                <summary>
                    <span class="summary-icon"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="4 7 4 4 20 4 20 7" />
                            <line x1="9" x2="15" y1="20" y2="20" />
                            <line x1="12" x2="12" y1="4" y2="20" />
                        </svg></span>
                    Text & Content
                </summary>
                <div class="token-grid" id="editor-text"></div>
            </details>
            <details>
                <summary>
                    <span class="summary-icon"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path d="m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z" />
                            <path d="m13 13 6 6" />
                        </svg></span>
                    Actions & Buttons
                </summary>
                <div class="token-grid" id="editor-action"></div>
            </details>
            <details>
                <summary>
                    <span class="summary-icon"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <rect width="18" height="18" x="3" y="3" rx="2" ry="2" />
                            <line x1="3" x2="21" y1="12" y2="12" />
                            <line x1="12" x2="12" y1="3" y2="21" />
                        </svg></span>
                    Borders & Dividers
                </summary>
                <div class="token-grid" id="editor-border"></div>
            </details>
            <details>
                <summary>
                    <span class="summary-icon"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
                        </svg></span>
                    Status & Feedback
                </summary>
                <div class="token-grid" id="editor-status"></div>
            </details>
        </div>

        <div class="separator"></div>

        <button id="create-theme-btn" class="primary big-btn" style="width: 100%;">
            <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path
                        d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" />
                    <path d="M5 3v4" />
                    <path d="M19 17v4" />
                    <path d="M3 5h4" />
                    <path d="M17 19h4" />
                </svg></span> Create Variables Collection
        </button>
    </div>
</div>

<style>
    /* Theme Section Specific Styles */
    .step-description {
        font-size: var(--font-size-sm);
        color: var(--text-secondary);
        margin-bottom: var(--space-4);
    }

    .semantic-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-4);
        margin-bottom: var(--space-4);
    }

    .semantic-card {
        display: flex;
        flex-direction: column;
        gap: var(--space-2);
        padding: var(--space-4);
        background: var(--bg-surface-hover);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-lg);
    }

    .semantic-icon {
        font-size: 20px;
    }

    .semantic-label {
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-semibold);
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: var(--letter-spacing-wide);
    }

    .status-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: var(--space-3);
    }

    .status-card {
        display: flex;
        flex-direction: column;
        gap: var(--space-2);
        padding: var(--space-3);
        background: var(--bg-surface-hover);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-md);
    }

    .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: var(--radius-full);
    }

    .status-label {
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-medium);
        color: var(--text-secondary);
    }

    .preview-section {
        border: 1px solid var(--accent-primary);
        background: linear-gradient(145deg, var(--accent-primary-muted), var(--bg-surface));
    }

    .preview-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--space-4);
    }

    .theme-mode-switch {
        display: flex;
        gap: var(--space-1);
        padding: var(--space-1);
        background: var(--bg-surface);
        border-radius: var(--radius-lg);
    }

    .mode-switch-btn {
        display: flex;
        align-items: center;
        gap: var(--space-1);
        padding: var(--space-2) var(--space-3);
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-medium);
        background: transparent;
        border: none;
        border-radius: var(--radius-md);
        color: var(--text-tertiary);
        cursor: pointer;
        transition: all var(--transition-fast);
    }

    .mode-switch-btn:hover {
        color: var(--text-secondary);
    }

    .mode-switch-btn.active {
        background: var(--bg-surface-active);
        color: var(--text-primary);
    }

    .theme-preview-board {
        min-height: 250px;
        padding: var(--space-6);
        background: var(--bg-surface);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-xl);
        margin-bottom: var(--space-6);
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-4);
        align-content: flex-start;
        transition: all var(--transition-normal);
    }

    .editor-accordion details summary {
        gap: var(--space-2);
    }

    .summary-icon {
        font-size: var(--font-size-md);
    }
</style>